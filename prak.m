# Load dataA0 = xlsread('2011aggr_ispr.xlsx','ТИоц','D5:BJ66');A = xlsread('tri-2012.xlsx','ТИоц','D5:BJ66'); #-nalog# Metricsfunction result = MAPE(Xtrue, X) # Mean absolute percentage error  diff = abs(Xtrue - X);  errors = diff ./ Xtrue * 100;  errors(isnan(errors))=0; # 0/0 occasions  errors(isinf(errors))=0; # 1/0 occasions   result = sum(sum(errors));endfunctionfunction result = WAPE(Xtrue, X) # Weighted absolute percentage error  diff = abs(Xtrue - X);  s = sum(sum(Xtrue));  result = sum(sum(diff / s * 100));endfunctionfunction result = SWAD(Xtrue, X) # Standardized weighted absolute difference  diff = abs(Xtrue - X);  mult = Xtrue .* diff;  sqr = Xtrue .* Xtrue;  s = sum(sum(sqr));  result = sum(sum(mult)) / s;endfunctionfunction psi = PsiStat(Xtrue, X) # Psi statistic  s = (Xtrue + X) / 2;  inf1 = Xtrue ./ s;  loged1 = log(inf1);  loged1(isnan(loged1))=0; # 0/0 occasions  loged1(isinf(loged1))=0; # 1/0 occasions   left = Xtrue .* loged1;  inf2 = X ./ s;  loged2 = log(inf2);  loged2(isnan(loged2))=0; # 0/0 occasions  loged2(isinf(loged2))=0; # 1/0 occasions   right = X .* loged2;  inform = sum(sum(left + right));  summ = sum(sum(Xtrue));  psi = inform / summ;endfunctionfunction Rsqr = RSQ(Xtrue, X) # Coefficient of determination  var = Xtrue - mean(mean(Xtrue));  TSS = sum(sum(var .* var));  e = Xtrue - X;  ESS = sum(sum(e .* e));  Rsqr = 1 - ESS/TSS;endfunctionfunction result = N0(Xtrue, X) # Number of zero elements in X, whose corresponding elements are nonzero in Xtrue  inds = find(~X);  result = size(find(~Xtrue(inds)),1);endfunctionprintf("MAPE: %f\n", MAPE(A0, A));printf("WAPE: %f\n", WAPE(A0, A));printf("SWAD: %f\n", SWAD(A0, A));printf("PsiStat: %f\n", PsiStat(A0, A));printf("RSQ: %f\n", RSQ(A0, A));printf("N0: %f\n", N0(A0, A));